<!DOCTYPE html>
<html>
<head>
    <title>Google Calendar Scheduling Client</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://apis.google.com/js/api.js"></script>
    <style>
        body { padding: 20px; }
    </style>
</head>
<body>

<div class="container">
    <div class="card shadow-lg mt-5" style="max-width: 600px; margin: auto;">
        <div class="card-body">
            <h3 class="card-title text-center">Google Calendar Scheduling Client</h3>
            <form id="schedule-form">
                <div class="form-group">
                    <label for="date">Select Date:</label>
                    <input type="date" id="date" class="form-control" required>
                </div>

                <div class="form-group">
                    <label for="time">Select Time:</label>
                    <input type="time" id="time" class="form-control" required>
                </div>

                <button type="submit" class="btn btn-primary w-100">Check Availability</button>
            </form>

            <div id="result" class="mt-4"></div>
        </div>
    </div>
</div>

<script>
    const CLIENT_ID = "321777232839-p5830p6n8dcvmqb0diup7hc76hgq7ql8.apps.googleusercontent.com";
    const API_KEY = "HEI_Key";
    const DISCOVERY_DOCS = ["https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest"];
    const SCOPES = "https://www.googleapis.com/auth/calendar.readonly";

    function handleClientLoad() {
        gapi.load('client:auth2', initClient);
    }

    function initClient() {
        gapi.client.init({
            apiKey: API_KEY,
            clientId: CLIENT_ID,
            discoveryDocs: DISCOVERY_DOCS,
            scope: SCOPES
        }).then(() => {
            console.log('Google API Initialized');
        });
    }

    function checkAvailability(date, time) {
        const dateTime = new Date(`${date}T${time}:00Z`);
        const endDateTime = new Date(dateTime.getTime() + 30 * 60000); // 30 minutes later

        gapi.client.calendar.events.list({
            'calendarId': 'primary',
            'timeMin': dateTime.toISOString(),
            'timeMax': endDateTime.toISOString(),
            'singleEvents': true,
            'orderBy': 'startTime'
        }).then(response => {
            const events = response.result.items;

            if (events.length > 0) {
                $('#result').html('<div class="alert alert-danger">Time slot is unavailable.</div>');
            } else {
                $('#result').html('<div class="alert alert-success">Time slot is available!</div>');
            }
        });
    }

    $(document).ready(() => {
        $('#schedule-form').submit(event => {
            event.preventDefault();
            const date = $('#date').val();
            const time = $('#time').val();

            checkAvailability(date, time);
        });

        handleClientLoad();
    });
</script>

</body>
</html>
